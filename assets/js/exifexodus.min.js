(function(){var e,t,n,r,o,a,i,l,u,s,f,p,c,d,m,g,h,v,y,b,L,w,E,R,F={}.hasOwnProperty;for(w=function(e,t){var n,r,o;if(!t)return alert("ExifExodus: "+e);if(confirm("ExifExodus: "+e+" Click OK to open your EXIF-free images in new tabs.")){for(r=0,o=t.length;o>r;r++)n=t[r],open(URL.createObjectURL(n),"_blank");return null}},b=["HTMLCanvasElement","FileReader","FormData","Uint8Array","ArrayBuffer","Blob","URL","Worker"],f=0,m=b.length;m>f;f++)if(n=b[f],!(n in window))return w("Your browser is too old to support ExifExodus. (Missing "+n+" support). Try using a modern browser like Chrome, Firefox, or Safari."),!1;for(v="exifexodus",c="image/jpeg",p=1,u="data:image/jpeg;base64,".length,l={},R=XMLHttpRequest.prototype.send,E=XMLHttpRequest.prototype.open,o=FormData.prototype.append,i=HTMLFormElement.prototype.submit,L=["readAsDataURL","readAsArrayBuffer","readAsBinaryString","readAsText"],a=function(e){return l[e]=FileReader.prototype[e],FileReader.prototype[e]=function(n,r){return n.type!==c?l[e].call(this,n):t(n,function(t){return function(n){return l[e].call(t,n,r)}}(this))}},d=0,g=L.length;g>d;d++)h=L[d],a(h);XMLHttpRequest.prototype.send=function(e){var n,r,a,i,l,u,s,f,p,c;if(e instanceof FormData&&e[v]){i=[],r=new FormData,f=e[v];for(l in f)F.call(f,l)&&(c=f[l],c.file&&c.file instanceof File?i.push(c):o.call(r,l,c));if(i.length){for(p=i.length,n=function(e){return function(n){return t(n.file,function(t){return o.call(r,n.name,t,n.filename),--p?void 0:R.call(e,r)})}}(this),u=0,s=i.length;s>u;u++)a=i[u],n(a);return void 0}return R.apply(this,arguments)}return R.apply(this,arguments)},XMLHttpRequest.prototype.open=function(e,t){return"blob:"!==(null!=t?t.slice(0,5):void 0)?E.apply(this,arguments):void 0},FormData.prototype.append=function(e,t,n){var r;return this[v]||(this[v]={}),this[v][e]=t instanceof File?(r={},r[v]={name:e,file:t,filename:n}):t,o.apply(this,arguments)},HTMLFormElement.prototype.submit=function(){return y.call(this)},"toBlob"in HTMLCanvasElement.prototype||(r=function(){return self.onmessage=function(e){var t,n,r,o,a,i;for(t=e.data,o=t.length,i=new Uint8Array(new ArrayBuffer(o)),n=r=0,a=o;a>=0?a>r:r>a;n=a>=0?++r:--r)i[n]=t.charCodeAt(n);return self.postMessage(new Blob([i.buffer],{type:"image/jpeg"})),self.close()}},e=URL.createObjectURL(new Blob(["("+r.toString()+")()"],{type:"application/javascript"}))),t=function(t,n){var r;return r=new FileReader,r.addEventListener("load",function(){var t;return t=new Image,t.addEventListener("load",function(){var r,o,a,i;return a=t.width,o=t.height,r=document.createElement("canvas"),r.width=a,r.height=o,r.getContext("2d").drawImage(t,0,0,a,o),r.toBlob?r.toBlob(n,c,p):(i=new Worker(e),i.onmessage=function(e){return n(e.data)},i.postMessage(atob(r.toDataURL(c,p).slice(u))))}),t.src=r.result}),l.readAsDataURL.call(r,t)},y=function(e){var n,r,a,l,u,s,f,p,d,m,g,h,v,y,b,L,F,A,M;for(d=e instanceof Event,u=d?e.target:this,p=u.querySelectorAll("input"),g=[],r=[],s=new FormData,h=0,v=p.length;v>h;h++)if(f=p[h],f.value)if("file"===f.type)for(A=f.files,L=0,y=A.length;y>L;L++)a=A[L],a.type===c&&g.push({file:a,name:f.name});else o.call(s,f.name,f.value);if(!g.length)return void(d||i.call(this));if(d&&(e.preventDefault(),e.stopImmediatePropagation()),!(n=u.getAttribute("action")))return w("Can't proceed, the upload form has no action URL.",r);for(M=g.length,l=function(e){return t(e.file,function(t){var a;return r.push(t),o.call(s,e.name,t,e.file.name),--M?void 0:(a=new XMLHttpRequest,a.onreadystatechange=function(){var e,t,n;return 4===a.readyState?200>=(e=a.status)&&300>e?"document"===a.responseType||/<[\w\W]*>/.test(a.responseText)?(n=u.getAttribute("target"))&&"_blank"!==n&&"_self"!==n&&"_parent"!==n&&"_top"!==n?null!=(t=document.getElementById(n))?t.innerHTML=a.response:void 0:document.write(a.response):w("Uploaded image but received ambiguous response from server.",r):w("Attempted upload of EXIF-free images but received an error response from the server (code "+a.status+").",r):void 0},a.onerror=function(){return w("Something went wrong submitting the upload form.",r)},E.call(a,u.getAttribute("method")||"GET",n),R.call(a,s))})},F=0,b=g.length;b>F;F++)m=g[F],l(m);return null},s=function(){return addEventListener("submit",y,!0)},"complete"===document.readyState?s():document.addEventListener("DOMContentLoaded",s)}).call(this);