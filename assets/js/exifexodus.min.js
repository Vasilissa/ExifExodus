(function(){var e,t,n,r,o,a,i,l,u,s,f,p,c,d,m,g,h,v,y,b,L,w,E,R,F={}.hasOwnProperty;for(m=function(e,t){var n,r,o;if(!t)return alert("ExifExodus: "+e);if(confirm("ExifExodus: "+e+" Click OK to open your EXIF-free images in new tabs.")){for(r=0,o=t.length;o>r;r++)n=t[r],open(URL.createObjectURL(n),"_blank");return null}},E=["HTMLCanvasElement","FileReader","FormData","Uint8Array","ArrayBuffer","Blob","URL","Worker"],y=0,L=E.length;L>y;y++)if(n=E[y],!(n in window))return m("Your browser is too old to support ExifExodus. (Missing "+n+" support). Try using a modern browser like Chrome, Firefox, or Safari."),!1;for(c="exifexodus",f="image/jpeg",s=1,l="data:image/jpeg;base64,".length,i={},h=XMLHttpRequest.prototype.send,g=XMLHttpRequest.prototype.open,o=FormData.prototype.append,a=HTMLFormElement.prototype.submit,R=["readAsDataURL","readAsArrayBuffer","readAsBinaryString","readAsText"],v=function(e){return i[e]=FileReader.prototype[e],FileReader.prototype[e]=function(n,r){return n.type!==f?i[e].call(this,n):t(n,function(t){return function(n){return i[e].call(t,n,r)}}(this))}},b=0,w=R.length;w>b;b++)p=R[b],v(p);XMLHttpRequest.prototype.send=function(e){var n,r,a,i,l,u,s,f,p,d;if(e instanceof FormData&&e[c]){a=[],n=new FormData,d=e[c];for(i in d)F.call(d,i)&&(u=d[i],u.file&&u.file instanceof File?a.push(u):o.call(n,i,u));if(a.length){for(l=a.length,s=function(e){return function(r){return t(r.file,function(t){return o.call(n,r.name,t,r.filename),--l?void 0:h.call(e,n)})}}(this),f=0,p=a.length;p>f;f++)r=a[f],s(r);return void 0}return h.apply(this,arguments)}return h.apply(this,arguments)},XMLHttpRequest.prototype.open=function(e,t){return"blob:"!==(null!=t?t.slice(0,5):void 0)?g.apply(this,arguments):void 0},FormData.prototype.append=function(e,t,n){var r;return this[c]||(this[c]={}),this[c][e]=t instanceof File?(r={},r[c]={name:e,file:t,filename:n}):t,o.apply(this,arguments)},HTMLFormElement.prototype.submit=function(){return d.call(this)},"toBlob"in HTMLCanvasElement.prototype||(r=function(){return self.onmessage=function(e){var t,n,r,o,a;for(t=e.data,r=t.length,o=new Uint8Array(new ArrayBuffer(r)),n=a=0;r>=0?r>a:a>r;n=r>=0?++a:--a)o[n]=t.charCodeAt(n);return self.postMessage(new Blob([o.buffer],{type:"image/jpeg"})),self.close()}},e=URL.createObjectURL(new Blob(["("+r.toString()+")()"],{type:"application/javascript"}))),t=function(t,n){var r;return r=new FileReader,r.addEventListener("load",function(){var t;return t=new Image,t.addEventListener("load",function(){var r,o,a,i;return a=t.width,o=t.height,r=document.createElement("canvas"),r.width=a,r.height=o,r.getContext("2d").drawImage(t,0,0,a,o),r.toBlob?r.toBlob(n,f,s):(i=new Worker(e),i.onmessage=function(e){return n(e.data)},i.postMessage(atob(r.toDataURL(f,s).slice(l))))}),t.src=r.result}),i.readAsDataURL.call(r,t)},d=function(e){var n,r,i,l,u,s,p,c,d,v,y,b,L,w,E,R,F,A,M;for(c=e instanceof Event,l=c?e.target:this,p=l.querySelectorAll("input"),v=[],r=[],u=new FormData,L=0,E=p.length;E>L;L++)if(s=p[L],s.value)if("file"===s.type)for(M=s.files,w=0,R=M.length;R>w;w++)i=M[w],i.type===f&&v.push({file:i,name:s.name});else o.call(u,s.name,s.value);if(!v.length)return void(c||a.call(this));if(c&&(e.preventDefault(),e.stopImmediatePropagation()),!(n=l.getAttribute("action")))return m("Can't proceed, the upload form has no action URL.",r);for(y=v.length,b=function(e){return t(e.file,function(t){var a;return r.push(t),o.call(u,e.name,t,e.file.name),--y?void 0:(a=new XMLHttpRequest,a.onreadystatechange=function(){var e,t,n;return 4===a.readyState?200>=(t=a.status)&&300>t?"document"===a.responseType||/<[\w\W]*>/.test(a.responseText)?(e=l.getAttribute("target"))&&"_blank"!==e&&"_self"!==e&&"_parent"!==e&&"_top"!==e?null!=(n=document.getElementById(e))?n.innerHTML=a.response:void 0:document.write(a.response):m("Uploaded image but received ambiguous response from server.",r):m("Attempted upload of EXIF-free images but received an error response from the server (code "+a.status+").",r):void 0},a.onerror=function(){return m("Something went wrong submitting the upload form.",r)},g.call(a,l.getAttribute("method")||"GET",n),h.call(a,u))})},A=0,F=v.length;F>A;A++)d=v[A],b(d);return null},u=function(){return addEventListener("submit",d,!0)},"complete"===document.readyState?u():document.addEventListener("DOMContentLoaded",u)}).call(this);