{"version":3,"sources":["site.coffee","site.js"],"names":["blobWorker","cleanImage","createBlob","headerSize","jpgQual","jpgType","missing","outputHidden","setDimensions","wHeight","wWidth","length","cons","j","len1","ref","window","HTMLCanvasElement","prototype","self","onmessage","e","binary","i","len","view","data","Uint8Array","ArrayBuffer","charCodeAt","postMessage","Blob","buffer","type","close","URL","createObjectURL","toString","file","cb","reader","alert","FileReader","addEventListener","img","Image","canvas","height","width","worker","document","createElement","getContext","drawImage","toBlob","Worker","atob","toDataURL","slice","src","result","readAsDataURL","innerWidth","innerHeight","logo","output","photoDrop","getElementById","arg","x","y","style","transform","preventDefault","ondragenter","this","className","ondragover","ondragleave","ondrop","results","dataTransfer","files","push","blob","appendChild","call"],"mappings":"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","file":"site.js","sourcesContent":["jpgType      = 'image/jpeg'\njpgQual      = 1\nheaderSize   = 'data:image/jpeg;base64,'.length\noutputHidden = true\nmissing      = do ->\n  for cons in ['HTMLCanvasElement', 'FileReader', 'Uint8Array', 'ArrayBuffer',\n               'Blob', 'URL', 'Worker']\n    return cons unless cons of window\n\n\nunless 'toBlob' of HTMLCanvasElement::\n  createBlob = ->\n    self.onmessage = (e) ->\n      binary  = e.data\n      len     = binary.length\n      view    = new Uint8Array new ArrayBuffer len\n      view[i] = binary.charCodeAt i for i in [0...len]\n      self.postMessage new Blob [view.buffer], type: 'image/jpeg'\n      self.close()\n\n\n  blobWorker = URL.createObjectURL new Blob [\"(#{ createBlob.toString() })()\"],\n    type: 'application/javascript'\n\n\ncleanImage = (file, cb) ->\n  if missing\n    alert \"Sorry, your browser is too old to support ExifExodus.\n           (Missing #{ missing } support)\"\n\n  reader = new FileReader\n  reader.addEventListener 'load', ->\n    img = new Image\n    img.addEventListener 'load', ->\n      {width, height} = img\n      canvas          = document.createElement 'canvas'\n      canvas.width    = width\n      canvas.height   = height\n\n      canvas.getContext('2d').drawImage img, 0, 0, width, height\n\n      if canvas.toBlob\n        canvas.toBlob cb, jpgType, jpgQual\n      else\n        worker = new Worker blobWorker\n        worker.onmessage = (e) -> cb e.data\n        worker.postMessage atob canvas.toDataURL(jpgType, jpgQual)[headerSize...]\n\n    img.src = reader.result\n\n  reader.readAsDataURL file\n\n\nwWidth = wHeight = 1\n\nsetDimensions = ->\n  wWidth  = window.innerWidth\n  wHeight = window.innerHeight\n\n\ndocument.addEventListener 'DOMContentLoaded', ->\n  setDimensions()\n  logo = document.getElementById 'logo-text'\n\n  addEventListener 'mousemove', ({x, y}) ->\n    logo.style.transform =\n      \"translate3d(#{ (x - (wWidth / 2)) / -100 }px, #{ (y - (wHeight / 2)) / -100 }px, 0)\"\n\n\n  addEventListener 'resize', setDimensions\n\n\n  document.getElementById('bookmarklet-btn').addEventListener 'click', (e) ->\n    e.preventDefault()\n    alert 'Drag this button to your bookmarks bar!'\n\n\n  photoDrop = document.getElementById 'photo-drop'\n  output    = document.getElementById 'output'\n\n  photoDrop.ondragenter = (e) ->\n    e.preventDefault()\n    @className = 'drag-hover'\n\n  photoDrop.ondragover = (e) ->\n    e.preventDefault()\n\n  photoDrop.ondragleave = ->\n    @className = ''\n\n  photoDrop.ondrop = (e) ->\n    e.preventDefault()\n    @className = ''\n    for file in e.dataTransfer.files then do (file) ->\n      unless file.type is jpgType\n        return alert 'Sorry, ExifExodus only works with JPG files.'\n\n      cleanImage file, (blob) ->\n        img     = document.createElement 'img'\n        img.src = URL.createObjectURL blob\n        output.appendChild img\n\n        if outputHidden\n          output.className = ''\n          outputHidden     = false\n\n",null],"sourceRoot":"/source/"}